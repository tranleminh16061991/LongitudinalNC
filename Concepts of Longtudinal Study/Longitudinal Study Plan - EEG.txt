https://www.perplexity.ai/search/you-are-an-expert-in-the-field-WRZiCPohQciE3njBKxpExg


#My new Workflow:

A. Data preprocessing
Start from the raw Chosun 5‑year dataset, clean core diagnostic and MRI–PET variables, and standardize labels.

Clean COGNITIVESTAT (trim, remove punctuation/spaces), restrict to valid codes (CN, SMI, aMCI, naMCI, AD), and collapse into a 3‑level diagnosis (CN, MCI, AD).

Clean APOE, Cold–Heat pattern, sex, and MRI–PET textual fields and derive a robust binary MRIPET variable (positive/negative/NA) after handling mixed or error labels.

Select analysis variables, build impedance‑derived features, and perform BIA QC.

Keep IDs, visit dates, demographics, cognitive tests (MMSE, SNSB domains), anthropometry, whole‑body composition, and detailed segmental BIA (Z, Xc across frequencies).

Derive segmental resistances 
R
R from Z and Xc for each limb and trunk at 5, 50, and 250 kHz, plus composite upper/lower indices (R, Xc, PA, ECW/TBW, water‑to‑lean ratios).

Identify and exclude subjects with non‑physiologic impedance spectra by checking monotonicity of Z and R across frequencies (5→50→250 kHz) and removing those with increasing patterns.

Harmonize variable types, handle implausible values, and impute cognitive scores.

Convert predefined numeric and factor variables using a central clean_numeric() function to standardize special missing codes to NA.

Restrict to AGE ≥ 55 and diagnosis ∈ {CN, MCI, AD}, remove additional problematic IDs, and set implausible BMI, WHR, and TBW/FFM to NA, then recompute them when height/weight and waist/hip or TBW/FFM are valid.

Within each diagnosis stratum (CN, MCI, AD), apply MICE with predictive mean matching to jointly impute missing values in MMSE and the five SNSB domain scores, then merge the completed cognition back into the main dataset.​

Flag multivariate outliers and define the final clean longitudinal dataset.

Compute z‑scores on a prespecified panel of key clinical and BIA variables and flag observations with any |z| > 3 as outlier_extreme.

Retain both a full imputed dataset with the outlier flag and an outlier‑clean dataset (outlier_extreme = 0).

Save the final cleaned, imputed longitudinal dataset (e.g., Chosun5y_BIApreprocess_clean.csv) as the input for baseline and longitudinal analyses.

B. Baseline cohort definition and baseline comparisons
Construct longitudinal structure and define diagnostic change groups.

From the clean dataset, keep participants with ≥2 visits and order records by subject and visit date.

For each subject, derive Initial_Status and Final_Status, create a Transition label (e.g. “CN – MCI”), and classify into clinically meaningful Change_Type categories (StableCN, CNtransitMCI, etc.).

Compute visit_count, baseline date, within‑subject elapsed_years, and follow‑up interval from first to last visit; restrict to subjects with at least ~11 months of follow‑up.

Define the analytic baseline cohort (StableCN vs CNtransitMCI).

Restrict to two groups of interest: Change_Type ∈ {StableCN, CNtransitMCI}.

For each subject, select the earliest visit as baseline, forming df_baseline, and set Change_Type (StableCN as reference) and SEX as factors.

Perform baseline descriptive and adjusted comparisons.

Table 1 (unadjusted): Compare demographics, mood scales, visit_count, MMSE, and SNSB domains between StableCN and CNtransitMCI using CreateTableOne, plus variable‑specific tests (chi‑square/Fisher for categorical; t‑test/Wilcoxon for continuous) and effect sizes (Cramér’s V / Cohen’s h / Cohen’s d with CI).

Tables 2–3 (ANCOVA): For anthropometry/body composition and segmental BIA indices, fit linear models marker ~ Change_Type + AGE + SEX + EDUYR and use emmeans to obtain age/sex/education‑adjusted means, adjusted group differences with 95% CIs, p‑values, partial eta², and adjusted R².​

Summarize MRI–PET status at baseline for each group (counts and percentages of amyloid positive/negative/NA) to describe amyloid burden in StableCN vs CNtransitMCI.

Export baseline outputs for integration with longitudinal modeling.

Save baseline descriptive and ANCOVA tables (CSV/Excel) and any baseline figures; these document that baseline profiles and covariate adjustment are appropriate before proceeding to longitudinal LME modeling in parts C–H.​

C. Longitudinal Mixed Effects Modeling (LME)
For each marker:
Fit model:marker ~ elapsed_years * Change_Type + AGE + SEX + EDUYR + (1 + elapsed_years | USUBJID)
Use lmerTest::lmer() for fits
lapply() for batch over resting_qEEG_vars
Store fit objects and summaries for downstream reporting

D. Model Reporting & Visualization—Per Variable
Trajectory Visualization
Use plot_lmer_model_with_interaction_p and plot_lmer_interaction_with_p
plot_lmer_model_with_interaction_p: displays group trajectories, Wald test p-values
plot_lmer_interaction_with_p: displays full/reduced model comparison with LRT p-value for interaction
Slope Extraction & Comparison
Use analyze_longitudinal_trends to extract annual slopes, SEs, Wald p-values, Cohen’s d
Plotting Slope Differences & Significance
Use plot_slopes, plot_pvalues for marker-wise slope and significance visualization

E. Confirmatory Inference— PRIORITIZE LRT
Likelihood Ratio Test
Compare full model to reduced (no interaction term): anova(reduced, full)
Report χ², p-value for interaction term (elapsed_years × Change_Type)
Prefer LRT as main test for statistical inference due to sample size concerns
Wald Test (Secondary, Descriptive)
Extract and report Wald test p-values for each model parameter via summary(model)$coefficients
Use for descriptive interpretation
Effect Size
Calculate standardized slope difference (Cohen’s d):
(slopeCNtransitMCI−slopeStableCN)/Residual SD
Enhances clinical/biological interpretability

F. (Future/Post-hoc Expansion)
If more groups are added (e.g. "Reverted"), use emmeans for pairwise slope comparisons and multiple testing correction

G. Model Diagnostics
For each model:
Residual QQ plots, fitted vs residuals
Check random effects variance (diagnose convergence/warnings)
Summarize model statistics (AIC, BIC, marginal/conditional R²)

H. Summary Export
Tables
Annual slope by group, p-value (LRT + Wald), effect size, 95% CI, exported as .csv/.xlsx
Visual Outputs
Save spaghetti, trajectory, slope, and p-value plots for publication/self-archiving